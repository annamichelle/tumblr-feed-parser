<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Feed Parser</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- Le styles -->
	<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
	<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">

	<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
	<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<style>

		.post {
			margin-bottom: 20px;
		}

		.post .photo {
			border: 1px #eee solid;
		}

		/* 
		   Responsive youtube videos 
		   source: http://avexdesigns.com/responsive-youtube-embed/ 
		*/

		.video-container {
			position: relative;
			padding-bottom: 56.25%;
			padding-top: 30px; 
			height: 0; 
			overflow: hidden;
		}

		.video-container iframe,
		.video-container object,
		.video-container embed {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
		}

		/* end */
	</style>
</head>
<body>

	<div class="container">
		<h2>Tumblr Feed</h2>
		<div id="main"></div>
	</div> <!-- /container -->

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="//code.jquery.com/jquery.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.0.0/moment.min.js"></script>

	<!-- https://api.twitter.com/1/statuses/user_timeline/jeremymouton.json -->
	<script>

		var blog_url    = 'http://greentype.tumblr.com';
		var tumblr_feed = blog_url + '/api/read/json?callback=?';

		$.getJSON(tumblr_feed, function(data) {
			getPosts(data.posts);
		});

		// HELPERS
		function getPosts(json) {
			for( var i=0, l=json.length; i<l; i++ ) {
				formatPost(json[i]);
			}
		}

		function formatPost(post) {
			date    = moment(post['date'], 'ddd, D MMM YYYY HH:mm:ss').format('MMMM Do YYYY');
			content = post['regular-body'];
			type    = post.type;

			switch (type)
			{
			// Normal post
			case "regular":
				content = post['regular-body'];
				break;

			// Link post
			case "link":
				content = '<span class="link-text"><a href="' + post['link-url'] + 
				          'target="_blank">' + post['link-text'] + '</a></span>' +
				          '<span class="link-description"> ' + post['link-description'] + '</span>';
				break;

			// Video post
			case "video":
				content = '<div class="video-container">' + post['video-player-500'] + '</div><span class="video-caption">' + post['video-caption'] + '</span>';
				break;

			// Photo post
			case "photo":
				content = '<div class="photo"><img src="' + post['photo-url-1280'] + 
				          '" alt="' + post['photo-caption'] + '"></div>' +
				          '<span class="photo-caption">' + post['photo-caption'] + '</span>';
				break;
			}

			// Send it to the view
			$('#main').append('<div class="post row"><div class="span12"><span class="post-date">' + date + '</span><div class="content">' + content + '</div></div></div>');
		}

	</script>
</body>
</html>